<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classification functions â€¢ scapesClassification</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Classification functions">
<meta property="og:description" content="scapesClassification">
<meta property="og:image" content="https://ghtaranto.github.io/scapesClassification/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-light navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scapesClassification</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Implementation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Implementation</li>
    <li>
      <a href="../articles/scapesClassification_01_1_FormatInputs.html">Format inputs</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_01_2_RuleEvaluation.html">Rule evaluation</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_01_3_ClassRules.html">Classification rules</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_01_4_ClassFunctions.html">Classification functions</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_01_5_FunctionAnchorSeed.html">Function anchor.seed</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Working example
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Geomorphic management units (GMUs)</li>
    <li>
      <a href="../articles/scapesClassification_02_0_GMU.html">0. Overview</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_02_1_DATA.html">1. Format input data</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_02_2_ISU.html">2. Island shelf unit (ISU)</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_02_3_PKS.html">3. Local maxima on gridded data</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_02_4_OBJ.html">4. Independent objects on raster surfaces</a>
    </li>
    <li>
      <a href="../articles/scapesClassification_02_5_OBJ2.html">5. Raster object manipulation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ghTaranto/scapesClassification" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="scapesClassification_01_4_ClassFunctions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Classification functions</h1>
                        <h4 data-toc-skip class="author">Gerald H. Taranto</h4>
            
            <h4 data-toc-skip class="date">Tue 25, January, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ghTaranto/scapesClassification/blob/HEAD/vignettes/articles/scapesClassification_01_4_ClassFunctions.Rmd" class="external-link"><code>vignettes/articles/scapesClassification_01_4_ClassFunctions.Rmd</code></a></small>
      <div class="hidden name"><code>scapesClassification_01_4_ClassFunctions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="class-vectors">Class vectors<a class="anchor" aria-label="anchor" href="#class-vectors"></a>
</h2>
<ul>
<li><p>Class vectors map raster cells to numeric classes (or to NA-values if no class is attributed). The n<sup>th</sup> element of a class vector corresponds to the raster cell stored in the n<sup>th</sup> row of an <a href="scapesClassification_01_1_FormatInputs.html#attribute-table">attribute table</a>. Classification functions use class vectors to store the results of their classifications.</p></li>
<li><p>Class vectors are also used as function inputs. As inputs, they provide information about what cells have been classified and allow to consider class contiguity and class continuity in <a href="scapesClassification_01_2_RuleEvaluation.html">rule evaluation</a>.</p></li>
<li><p>Classification functions were designed to assign a classification number only to <em>unclassified cells</em> (NA-values in the class vector). Every time a class vector is provided as a function input, it is updated with the new classifications performed by the function, while previous classifications remain unchanged.</p></li>
<li><p>The sequential update of a class vector allows user to design multi-step classifications. At each step new pools of cell can be identified based on how they spatially relate with cells classified in previous classification steps.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="dummy-raster">Dummy raster<a class="anchor" aria-label="anchor" href="#dummy-raster"></a>
</h2>
<p>We will use a dummy raster to illustrate the <code>scapesClassification</code> functions (<a href="#figure1">Figure 1</a>). Before to start, we should compute its <a href="scapesClassification_01_1_FormatInputs.html#attribute-table">attribute table</a>, in which it is named <code>"dummy_var"</code>, and its <a href="scapesClassification_01_1_FormatInputs.html#list-of-neighborhoods">list of neighborhoods</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># LOAD LIBRARIES</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ghTaranto/scapesClassification" class="external-link">scapesClassification</a></span><span class="op">)</span>

<span class="co"># LOAD THE DUMMY RASTER</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"scapesClassification"</span><span class="op">)</span>, 
                 pattern <span class="op">=</span> <span class="st">"dummy_raster\\.tif"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE THE ATTRIBUTE TABLE</span>
<span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/attTbl.html">attTbl</a></span><span class="op">(</span><span class="va">r</span>, <span class="st">"dummy_var"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">at</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">##   Cell dummy_var</span>
<span class="co">## 1    1         1</span>
<span class="co">## 2    2         1</span>
<span class="co">## 3    3         1</span>

<span class="co"># COMPUTE THE LIST OF NEIGBORHOODS</span>
<span class="va">nbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ngbList.html">ngbList</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nbs</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">## $`1`</span>
<span class="co">## [1] 2 8 9</span>
<span class="co">## </span>
<span class="co">## $`2`</span>
<span class="co">## [1]  1  3  8  9 10</span>
<span class="co">## </span>
<span class="co">## $`3`</span>
<span class="co">## [1]  2  4  9 10 11</span></code></pre></div>
<p><a id="figure1"></a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PLOT RASTER</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/dummy_rast_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 1 -</strong> Dummy raster used to illustrate <code>scapesClassification</code> functions.</span>
</div>
</div>
<div class="section level2">
<h2 id="anchor-cell-functions">Anchor cell functions<a class="anchor" aria-label="anchor" href="#anchor-cell-functions"></a>
</h2>
<p><strong>Functions:</strong> <code><a href="../reference/anchor.svo.html">anchor.svo()</a></code>, <code><a href="../reference/anchor.cell.html">anchor.cell()</a></code> and <code><a href="../reference/cond.4.all.html">cond.4.all()</a></code>.</p>
<p><a href="scapesClassification_01_2_RuleEvaluation.html#focal-evaluation">Anchor cells</a> can be thought of as raster cells having particular characteristics from where the classification process can start. Anchor cells can be derived by: previous classifications, areas of constant environmental or geographic characteristics (e.g., flat areas), local maxima or minima (e.g., local peaks on a mountain ridge) or spatial objects (e.g., shapefiles).</p>
<p>Anchor cell functions can be easily identified because they do not necessarily require a class vector as an input.</p>
<div class="section level3">
<h3 id="anchor-svo">anchor.svo<a class="anchor" aria-label="anchor" href="#anchor-svo"></a>
</h3>
<p>The function <code><a href="../reference/anchor.svo.html">anchor.svo()</a></code> returns a vector of cell numbers extracted at the locations of a spatial object. Only for the examples of this section, we will add some NA-values to the dummy raster and consider a dummy polygon (<code>pol</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CELL NUMBERS OF THE DUMMY RASTER</span>
<span class="va">r_cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">49</span>, nrow <span class="op">=</span> <span class="fl">7</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># Dummy raster cell numbers</span>

<span class="co"># SET SOME NA-VALUE</span>
<span class="va">r_cn</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">17</span>, <span class="fl">18</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="co"># BULD A DUMMY POLYGON</span>
<span class="va">pol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.95</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.28</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.24</span>, <span class="fl">0.72</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.72</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>
<span class="va">pol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/spEasy.html" class="external-link">spPolygons</a></span><span class="op">(</span><span class="va">pol</span><span class="op">)</span>

<span class="co"># EMPTY RASTER TO PLOT anchor.svo RESULTS</span>
<span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">r_cn</span>; <span class="va">r2</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></code></pre></div>
<p>In <a href="#figure2">figure 2</a> we will show how the function arguments <code>only_NAs</code> and <code>fill_NAs</code> work.</p>
<ul>
<li><p><code>only_NAs = TRUE</code>, cell numbers extracted only for incomplete cases at the locations of a spatial object. Incomplete cases are cells having an NA-value in one or more layers of the <code>Raster*</code> object.</p></li>
<li><p><code>fill_NAs = TRUE</code>, cell numbers extracted at the locations of a spatial vector object <em>and</em> at contiguous locations that are to incomplete cases.</p></li>
</ul>
<p><a id="figure2"></a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMBINE PLOTS</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>


<span class="co"># PLOT 1</span>
<span class="co">################################################################################</span>
<span class="co"># only_NAs = FALSE; fill_NAs = FALSE</span>
<span class="va">ac</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.svo.html">anchor.svo</a></span><span class="op">(</span><span class="va">r_cn</span>, <span class="va">pol</span>, only_NAs <span class="op">=</span> <span class="cn">FALSE</span>, fill_NAs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r2</span><span class="op">[</span><span class="va">ac</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r2</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, colNA<span class="op">=</span> <span class="st">"grey"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,
     main <span class="op">=</span> <span class="st">"only_NAs = FALSE; fill_NAs = FALSE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pol</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2.5</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="co">################################################################################</span>

<span class="co"># PLOT 2</span>
<span class="co">################################################################################</span>
<span class="co"># only_NAs = TRUE; fill_NAs = FALSE</span>
<span class="va">ac</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.svo.html">anchor.svo</a></span><span class="op">(</span><span class="va">r_cn</span>, <span class="va">pol</span>, only_NAs <span class="op">=</span> <span class="cn">TRUE</span>, fill_NAs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">r2</span><span class="op">[</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="cn">NA</span>; <span class="va">r2</span><span class="op">[</span><span class="va">ac</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r2</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, colNA<span class="op">=</span> <span class="st">"grey"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,
     main <span class="op">=</span> <span class="st">"only_NAs = TRUE; fill_NAs = FALSE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pol</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2.5</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="co">################################################################################</span>

<span class="co"># PLOT 3</span>
<span class="co">################################################################################</span>
<span class="co"># only_NAs = FALSE; fill_NAs = TRUE</span>
<span class="va">ac</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.svo.html">anchor.svo</a></span><span class="op">(</span><span class="va">r_cn</span>, <span class="va">pol</span>, only_NAs <span class="op">=</span> <span class="cn">FALSE</span>, fill_NAs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">r2</span><span class="op">[</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="cn">NA</span>; <span class="va">r2</span><span class="op">[</span><span class="va">ac</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r2</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, colNA<span class="op">=</span> <span class="st">"grey"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,
     main <span class="op">=</span> <span class="st">"only_NAs = FALSE; fill_NAs = TRUE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pol</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2.5</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="co">################################################################################</span>

<span class="co"># PLOT 4</span>
<span class="co">################################################################################</span>
<span class="co"># only_NAs = TRUE; fill_NAs = TRUE</span>
<span class="va">ac</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.svo.html">anchor.svo</a></span><span class="op">(</span><span class="va">r_cn</span>, <span class="va">pol</span>, only_NAs <span class="op">=</span> <span class="cn">TRUE</span>, fill_NAs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">r2</span><span class="op">[</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="cn">NA</span>; <span class="va">r2</span><span class="op">[</span><span class="va">ac</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r2</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, colNA<span class="op">=</span> <span class="st">"grey"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,
     main <span class="op">=</span> <span class="st">"only_NAs = TRUE; fill_NAs = TRUE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pol</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2.5</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/anchor_svo_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 2 -</strong> <strong>Anchor.svo</strong>, extract cell numbers at the locations of a spatial polygon (red border). The plotted values correspond to raster cell numbers. Cells not showing a cell number are NA-cells (cells <code>c(9, 10, 11, 17, 18)</code>). <strong>In blue</strong>, cell numbers extracted by the function.</span>
</div>
<hr>
</div>
<div class="section level3">
<h3 id="anchor-cell">anchor.cell<a class="anchor" aria-label="anchor" href="#anchor-cell"></a>
</h3>
<p>The function <code><a href="../reference/anchor.cell.html">anchor.cell()</a></code> converts a vector of cell numbers into a class vector. In <a href="#figure3">figure 3</a> we will show how the function arguments <code>class2cell</code> and <code>class2nbs</code> work.</p>
<ul>
<li><p><code>class2cell = TRUE</code>, every cell of the argument <code>anchor</code> is included in the class vector.</p></li>
<li><p><code>class2nbs = TRUE</code>, cells adjacent to the cells of the argument <code>anchor</code> are included in the class vector.</p></li>
</ul>
<p>Setting <code>anchor = 1:7</code>:</p>
<p><a id="figure3"></a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CELL NUMBERS OF THE DUMMY RASTER</span>
<span class="va">r_cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">49</span>, nrow <span class="op">=</span> <span class="fl">7</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># Dummy raster cell numbers</span>

<span class="co"># COMBINE PLOTS</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="co"># PLOT 1</span>
<span class="co">################################################################################</span>
<span class="co"># class2cell = TRUE &amp; class2nbs = FALSE</span>
<span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.cell.html">anchor.cell</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, rstack <span class="op">=</span> <span class="va">r_cn</span>, class  <span class="op">=</span> <span class="fl">10</span>,
                  anchor <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,
                  class2cell <span class="op">=</span> <span class="cn">TRUE</span>,
                  class2nbs  <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># CONVERT CLASS VECTOR TO A RASTER AND PLOT</span>
<span class="va">r_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">r_cn</span>, index <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>, classVector <span class="op">=</span> <span class="va">cv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, 
     colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, main <span class="op">=</span> <span class="st">"class2cell=TRUE; class2nbs=FALSE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span>
<span class="co">################################################################################</span>

<span class="co"># PLOT 2</span>
<span class="co">################################################################################</span>
<span class="co"># class2cell = FALSE &amp; class2nbs = TRUE</span>
<span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.cell.html">anchor.cell</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, rstack <span class="op">=</span> <span class="va">r_cn</span>, class  <span class="op">=</span> <span class="fl">10</span>,
                  anchor <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,
                  class2cell <span class="op">=</span> <span class="cn">FALSE</span>,
                  class2nbs  <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># CONVERT CLASS VECTOR TO A RASTER AND PLOT</span>
<span class="va">r_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">r_cn</span>, index <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>, classVector <span class="op">=</span> <span class="va">cv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, 
     colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, main <span class="op">=</span> <span class="st">"class2cell=FALSE; class2nbs=TRUE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span>
<span class="co">################################################################################</span>

<span class="co"># PLOT 3</span>
<span class="co">################################################################################</span>
<span class="co"># class2cell = TRUE &amp; class2nbs = TRUE</span>
<span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anchor.cell.html">anchor.cell</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, rstack <span class="op">=</span> <span class="va">r_cn</span>, class  <span class="op">=</span> <span class="fl">10</span>,
                  anchor <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,
                  class2cell <span class="op">=</span> <span class="cn">TRUE</span>,
                  class2nbs  <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># CONVERT CLASS VECTOR TO A RASTER AND PLOT</span>
<span class="va">r_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span>r <span class="op">=</span> <span class="va">r_cn</span>, index <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>, classVector <span class="op">=</span> <span class="va">cv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, 
     colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span>, main <span class="op">=</span> <span class="st">"class2cell=TRUE; class2nbs=TRUE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r_cn</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/anchor_cell_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 3 -</strong> <strong>Anchor.cell</strong>, converts a vector of cell numbers into a class vector. <strong>In blue</strong>, cells included in the class vector using the cell number vector <code>1:7</code> as a function input. The plotted values correspond to raster cell numbers.</span>
</div>
<hr>
</div>
<div class="section level3">
<h3 id="cond-4-all">cond.4.all()<a class="anchor" aria-label="anchor" href="#cond-4-all"></a>
</h3>
<p>The function <code><a href="../reference/cond.4.all.html">cond.4.all()</a></code> can be used to evaluate <em>absolute test cell conditions</em> for all unclassified cells (see <code><a href="../reference/conditions.html">?conditions</a></code>, <a href="scapesClassification_01_3_ClassRules.html">classificaton rules</a> and <a href="scapesClassification_01_2_RuleEvaluation.html">rule evaluations</a>).</p>
<p>For example, we can identify all the cells of the dummy raster having a value of 1. Variables stored in the attribute table can be accessed by name, therefore we can write our condition as <code>"dummy_var == 1"</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ATTRIBUTE TABLE VARIABLES</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">at</span><span class="op">)</span>
<span class="co">## [1] "Cell"      "dummy_var"</span>

<span class="co"># COMPUTE THE CLASS VECTOR</span>
<span class="va">cv</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.all.html">cond.4.all</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, conditions <span class="op">=</span> <span class="st">"dummy_var == 1"</span>, class <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>, classVector <span class="op">=</span> <span class="va">cv</span><span class="op">)</span></code></pre></div>
<p>The element <code>cv</code> is a class vector having two unique values: (i) <code>10</code>, identifies cells having a value <code>=1</code>; <code>NA</code>, identifies unclassified cells.</p>
<p>The element <code>r_cv</code> is the class vector <code>cv</code> converted into a raster by the function <code><a href="../reference/cv.2.rast.html">cv.2.rast()</a></code>. It can be plotted and manipulated as a normal raster object (<a href="#figure4">Figure 4</a>).</p>
<p><a id="figure4"></a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span>
<span class="co">## [1] 10 NA</span>

<span class="co"># class = 10, cell with values 'dummy_var == 1'</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="st">"#78b2c4"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_all1_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 4 -</strong> Raster cell classification using the function <strong>cond.4.all</strong> and the rule <code>"dummy_var == 1"</code>. In <strong>blue</strong>, classified cells. In <strong>grey</strong>, unclassified cells.</span>
</div>
<hr>
<p>When no class vector is available, the function <code><a href="../reference/cond.4.all.html">cond.4.all()</a></code> can be used to start a classification process by identifying an initial group of anchor cells. It can also be used at other stages of a classification process.</p>
<p>For instance, consider the rule <code>"dummy_var &lt;= 3"</code>. This rule applied on our dummy raster would classify raster cells having values of 1, 2 and 3. However, if we provide the class vector <code>cv</code> as a function input, raster cells of value <code>=1</code> will be ignored because they were classified in a previous step (<a href="#figure5">Figure 5</a>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># UPDATE THE CLASS VECTOR</span>

<span class="co"># UPDATED CLASS VECTOR</span>
<span class="va">cv</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.all.html">cond.4.all</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, conditions <span class="op">=</span> <span class="st">"dummy_var &lt;= 3"</span>, class <span class="op">=</span> <span class="fl">1</span>,
                   
                   <span class="co"># INITIAL CLASS VECTOR</span>
                   classVector <span class="op">=</span> <span class="va">cv</span><span class="op">)</span> 

<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>, classVector <span class="op">=</span> <span class="va">cv</span><span class="op">)</span></code></pre></div>
<p>The class vector <code>cv</code> presents now three unique values: (i) <code>10</code>, identifies cells having a value <code>=1</code>; (ii) <code>1</code>, identifies cells having a value <code>&lt;=3 &amp; !=1</code>; <code>NA</code>, identifies unclassified cells.</p>
<p><a id="figure5"></a></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span>
<span class="co">## [1] 10  1 NA</span>

<span class="co"># class = 10, cell with values 'dummy_var == 1'</span>
<span class="co"># class = 1,  cell with values 'dummy_var =&lt; 3' (&amp; dummy_var != 1 - implicit condition)</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#cfad89"</span>, <span class="st">"#78b2c4"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_all2_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 5 -</strong> Two-step classification using the function <strong>cond.4.all</strong>. Step one (<strong>light blue</strong>), cells classified using the rule <code>"dummy_var == 1"</code>. Step two (<strong>brown</strong>), cells classified using the rule <code>"dummy_var &lt;= 3"</code>. In <strong>grey</strong>, unclassified cells. Note that the rule of step two do not overwrite the classification of step one.</span>
</div>
</div>
</div>
<div class="section level2">
<h2 id="user-condition-functions">User condition functions<a class="anchor" aria-label="anchor" href="#user-condition-functions"></a>
</h2>
<p><strong>Functions:</strong> <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code>, <code><a href="../reference/cond.reclass.html">cond.reclass()</a></code> and <code><a href="../reference/cond.4.all.html">cond.4.all()</a></code>.</p>
<p>User condition functions present the <code>conditions</code> argument and generally require a class vector as input. Excluding the function <code><a href="../reference/cond.4.all.html">cond.4.all()</a></code> (that can be considered both an anchor cell and a user condition function), user condition functions always perform <a href="scapesClassification_01_2_RuleEvaluation.html#focal-evaluation">focal evaluations</a>. Focal evaluations only test classification rules at positions adjacent to anchor and focal cells. Anchor and focal cells have to be provided as function inputs using the argument <code>nofn</code>.</p>
<p>A particular case of focal evaluation, is <a href="scapesClassification_01_2_RuleEvaluation.html#class-continuity">class continuity</a>. Class continuity join into the same class cells that share the same property(ies) and that are connected to the same anchor cell(s). User condition functions take into account class continuity when the classification number assigned with the argument <code>class</code> is also included in the argument <code>nofn</code>.</p>
<div class="section level3">
<h3 id="cond-4-nofn">cond.4.nofn<a class="anchor" aria-label="anchor" href="#cond-4-nofn"></a>
</h3>
<p>The function <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code> can be used to evaluate both relative and absolute conditions for cells neighboring specific classes (see <code><a href="../reference/conditions.html">?conditions</a></code>, <a href="scapesClassification_01_3_ClassRules.html">classificaton rules</a> and <a href="scapesClassification_01_2_RuleEvaluation.html#focal-evaluation">focal evaluation</a>).</p>
<p>As all other user condition functions, <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code> requires some initial focal cell. We can create an empty class vector and assume that <code>cell 25</code> is our initial focal cell. The focal cell will be identified by the numeric class <code>0</code> - but we could use any other number.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># SET CELL 25 AS A FOCAL CELL</span>
<span class="va">at</span><span class="op">$</span><span class="va">cv</span><span class="op">[</span><span class="va">at</span><span class="op">$</span><span class="va">Cell</span> <span class="op">==</span> <span class="fl">25</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></code></pre></div>
<p>We can now use the function <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code> to test an absolute test cell condition <code>"dummy_var &gt;= 3"</code> at locations adjacent to the focal cell (<a href="#figure6">Figure 6</a>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE THE CLASS VECTOR (do not consider class continuity)</span>
<span class="va">cv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                   ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                   
                   <span class="co"># CLASS VECTOR - INPUT</span>
                   classVector <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">cv</span>, 
                   
                   <span class="co"># FOCAL CELL CLASS</span>
                   nbs_of <span class="op">=</span> <span class="fl">0</span>, 
                   
                   <span class="co"># CLASSIFICATION NUMBER</span>
                   class <span class="op">=</span> <span class="fl">1</span>,  
                   
                   <span class="co"># ABSOLUTE CONDITION</span>
                   conditions <span class="op">=</span> <span class="st">"dummy_var &gt;= 3"</span><span class="op">)</span>


<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cv1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure6"></a></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv1</span><span class="op">)</span>
<span class="co">## [1] NA  1  0</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cell with values 'dummy_var &gt;= 3'</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv1</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_nofn1_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 6 -</strong> Classification using the function <strong>cond.4.nofn</strong> and the rule <code>"dummy_var &gt;= 3"</code>. In <strong>light blue</strong>, the initial focal cell; in <strong>brown</strong> cell meeting function conditions; in <strong>grey</strong>, unclassified cells. Only <strong>cells contiguous</strong> to the focal cell with values <code>&gt;=3</code> are identified by the function.</span>
</div>
<hr>
<p>When the classification number associated with the argument <code>class</code> is also included in the argument <code>nofn</code>, classifications take into account <a href="scapesClassification_01_2_RuleEvaluation.html#class-continuity">class continuity</a> (<a href="#figure7">Figure 7</a>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE THE CLASS VECTOR (consider class continuity)</span>
<span class="va">cv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                   ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                   
                   <span class="co"># CLASS VECTOR - INPUT</span>
                   classVector <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">cv</span>, 
                   
                   nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="co"># FOCAL CELL CLASS</span>
                              <span class="fl">1</span><span class="op">)</span>, <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># CLASSIFICATION NUMBER </span>
                   class <span class="op">=</span> <span class="fl">1</span>,     <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># ABSOLUTE CONDITION</span>
                   conditions <span class="op">=</span> <span class="st">"dummy_var &gt;= 3"</span><span class="op">)</span>


<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cv2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure7"></a></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv2</span><span class="op">)</span>
<span class="co">## [1] NA  1  0</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cell with values 'dummy_var &gt;= 3'</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv2</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_nofn2_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 7 -</strong> Classification using the function <strong>cond.4.nofn</strong> and the rule <code>"dummy_var &gt;= 3"</code>. In <strong>light blue</strong>, the initial focal cell; in <strong>brown</strong> cell meeting function conditions; in <strong>grey</strong>, unclassified cells. Only <strong>cells contiguous AND continuous</strong> to the focal cell with values <code>&gt;=3</code> are identified by the function.</span>
</div>
<hr>
<p><a href="scapesClassification_01_3_ClassRules.html#absolute-conditions"><em>Absolute neighborhood condition</em></a> are flagged by a variable name followed by curly brackets (<code><a href="https://rdrr.io/r/base/Paren.html" class="external-link">{}</a></code>). They compare the values of the test cell and of its neighborhood against a threshold value. Test cells are classified if the rule is true for at least as many evaluations as the ones specified by the argument <code>fn_perc</code>.</p>
<p>In the following example we will use the function <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code> with the arguments <code>conditions = "dummy_var{} &gt;= 3"</code> and <code>fn_perc = 1</code>. This means that the function will identify (<a href="#figure8">Figure 8</a>):</p>
<ul>
<li><p>cells whose value is <code>&gt;= 3</code>;</p></li>
<li><p><em>AND</em> whose all (<code>fn_perc = 1</code>) neighbor values are <code>&gt;= 3</code>;</p></li>
<li><p><em>AND</em> that are contiguous and continuous to the focal cell.</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE THE CLASS VECTOR (ABSOLUTE NEIGHBORHOOD CONDITION)</span>
<span class="va">cv3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                   ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                   
                   <span class="co"># CLASS VECTOR - INPUT</span>
                   classVector <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">cv</span>, 
                   
                   nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="co"># FOCAL CELL CLASS</span>
                              <span class="fl">1</span><span class="op">)</span>, <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># CLASSIFICATION NUMBER </span>
                   class <span class="op">=</span> <span class="fl">1</span>,     <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># ABSOLUTE NEIGHBORHOOD CONDITION</span>
                   conditions <span class="op">=</span> <span class="st">"dummy_var{} &gt;= 3"</span>,
                   
                   <span class="co"># RULE HAS TO BE TRUE FOR AT LEAST 100% OF THE EVALUATIONS</span>
                   fn_perc <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>


<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cv3</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure8"></a></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv3</span><span class="op">)</span>
<span class="co">## [1] NA  1  0</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cell with values 'dummy_var &gt;= 3'</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv3</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_nofn3_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 8 -</strong> Classification using the function <strong>cond.4.nofn</strong>, the rule <code>"dummy_var{} &gt;= 3"</code> and the argument <code>fn_perc = 1</code>. In <strong>light blue</strong>, the initial focal cell; in <strong>brown</strong> cell meeting function conditions; in <strong>grey</strong>, unclassified cells. Only cells with values <code>&gt;=3</code>, with neighboring cells with values <code>&gt;=3</code> and continuous with the focal cell are identified by the function.</span>
</div>
<hr>
<p><a href="scapesClassification_01_3_ClassRules.html#relative-conditions">Relative conditions</a> compare the values of contiguous cells. <em>Relative focal cell conditions</em> are flagged by a variable name followed by square brackets (<code>[]</code>). They compare the value of the test cell against the value of the focal cell (see <code><a href="../reference/conditions.html">?conditions</a></code> and <a href="scapesClassification_01_2_RuleEvaluation.html#cc">definitions</a>).</p>
<p>Note that if class continuity is considered, the pool of focal cells will change at each new iteration. Cell classified at one iteration will serve as focal cells in the next iteration (see <a href="scapesClassification_01_2_RuleEvaluation.html#class-continuity">class continuity</a>).</p>
<p>In the following example we will use the function <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code> with the argument <code>conditions = "dummy_var &gt; dummy_var[]"</code>. This means that the function will identify test cells with <code>dummy_var</code> values greater than the focal cell value (<code>dummy_var[]</code>) (<a href="#figure9">Figure 9</a>):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE THE CLASS VECTOR (RELATIVE FOCAL CELL CONDITION)</span>
<span class="va">cv4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                   ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                   
                   <span class="co"># CLASS VECTOR - INPUT</span>
                   classVector <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">cv</span>, 
                   
                   nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="co"># FOCAL CELL CLASS</span>
                              <span class="fl">1</span><span class="op">)</span>, <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># CLASSIFICATION NUMBER </span>
                   class <span class="op">=</span> <span class="fl">1</span>,     <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># RELATIVE FOCAL CELL CONDITION</span>
                   conditions <span class="op">=</span> <span class="st">"dummy_var &gt; dummy_var[]"</span><span class="op">)</span>


<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cv4</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure9"></a></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv4</span><span class="op">)</span>
<span class="co">## [1] NA  1  0</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cells with values greater than the value of the focal cell</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv4</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_nofn4_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 9 -</strong> Classification using the function <strong>cond.4.nofn</strong> and the rule <code>"dummy_var &gt; dummy_var[]"</code>. In <strong>light blue</strong>, the initial focal cell; in <strong>brown</strong> cell meeting function conditions; in <strong>grey</strong>, unclassified cells. Note that at the 1<sup>st</sup> iteration there are only two cells contiguous to the focal cell and with values <code>&gt;3</code> (brown cells with values <code>=5</code>). In the 2<sup>nd</sup> iteration the two brown cells of value 5 become focal cells; among their neighbors there is only one cell with a value <code>&gt;5</code> (the brown cell with value <code>=10</code>). Among the neighbors of the brown cell with value <code>=10</code>, none has values <code>&gt;10</code>. Therefore the function stops after the 2<sup>nd</sup> iteration.</span>
</div>
<hr>
<p><a href="scapesClassification_01_3_ClassRules.html#relative-conditions"><em>Relative neighborhood conditions</em></a> are flagged by a variable name followed by square brackets (<code><a href="https://rdrr.io/r/base/Paren.html" class="external-link">{}</a></code>). They compare the value of the test cell against the values of its neighborhood. Test cells are classified if the rule is true for at least as many evaluations as the ones specified by the argument <code>fn_perc</code>.</p>
<p>In the following example we will use the function <code><a href="../reference/cond.4.nofn.html">cond.4.nofn()</a></code> with the arguments <code>conditions = "dummy_var &gt; dummy_var{}"</code> and <code>fn_perc = 0.6</code>. This means that the function will identify (<a href="#figure10">Figure 10</a>):</p>
<ul>
<li><p>cells whose value is greater than 60% of its neighbors;</p></li>
<li><p><em>AND</em> that are contiguous and continuous to the focal cell.</p></li>
</ul>
<p>For neighborhoods of 8 cells, <code>fn_perc = 0.6</code> means that the value of the test cell has to be <code>&gt;</code> than at least 5 of its neighbors.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE THE CLASS VECTOR (RELATIVE NEIGHBORHOOD CONDITION)</span>
<span class="va">cv5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                   ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                   
                   <span class="co"># CLASS VECTOR - INPUT</span>
                   classVector <span class="op">=</span> <span class="va">at</span><span class="op">$</span><span class="va">cv</span>, 
                   
                   nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="co"># FOCAL CELL CLASS</span>
                              <span class="fl">1</span><span class="op">)</span>, <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># CLASSIFICATION NUMBER </span>
                   class <span class="op">=</span> <span class="fl">1</span>,     <span class="co"># CLASSIFICATION NUMBER</span>
                   
                   <span class="co"># RELATIVE NEIGHBORHOOD CONDITION</span>
                   conditions <span class="op">=</span> <span class="st">"dummy_var &gt; dummy_var{}"</span>,
                   
                   <span class="co"># RULE HAS TO BE TRUE FOR AT LEAST 60% OF THE EVALUATIONS</span>
                   fn_perc <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>


<span class="co"># CONVERT THE CLASS VECTOR INTO A RASTER</span>
<span class="va">r_cv5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>, classVector <span class="op">=</span> <span class="va">cv5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure10"></a></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv5</span><span class="op">)</span>
<span class="co">## [1] NA  1  0</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cells with values greater than the value of 60% of their neighbors</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv5</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_4_nofn5_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 10 -</strong> Classification using the function <strong>cond.4.nofn</strong>, the rule <code>"dummy_var &gt; dummy_var{}"</code> and the argument <code>fn_perc = 0.6</code>. In <strong>light blue</strong>, the initial focal cell; in <strong>brown</strong> cell meeting function conditions; in <strong>grey</strong>, unclassified cells. Note that in brown are only cells that present: (i) values greater than the values of 5 or more of their neighbors; (ii) continuity with the initial focal cell.</span>
</div>
<hr>
</div>
<div class="section level3">
<h3 id="cond-reclass">cond.reclass<a class="anchor" aria-label="anchor" href="#cond-reclass"></a>
</h3>
<p>The function <code><a href="../reference/cond.reclass.html">cond.reclass()</a></code> evaluates conditions for cells of a class and reclassify them if conditions are true. It can consider <a href="scapesClassification_01_3_ClassRules.html#absolute-conditions"><em>absolute conditions</em></a> and <a href="scapesClassification_01_3_ClassRules.html#relative-conditions"><em>relative neighborhood conditions</em></a>.</p>
<p>In the following example we will use the function <code><a href="../reference/cond.reclass.html">cond.reclass()</a></code> with the arguments <code>conditions = "dummy_var{} &gt;= 3"</code> and <code>fn_perc = 1</code>. The class vector computed in the last example (<code>cv5</code> - <a href="#figure10">Figure 10</a>) will be used as a function input. This vector has classes <code>0</code> (initial focal cell) and <code>1</code> (classified cells). Cells of class 1 will be reclassified if their value and the value of all their neighbors is <code>&gt;=3</code> (<a href="#figure11">Figure 11</a>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># RECLASSIFY</span>
<span class="va">cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cond.reclass.html">cond.reclass</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                   ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                    
                   <span class="co"># CLASS VECTOR COMPUTED WITH THE RULE "dummy_var &gt; dummy_var{}"</span>
                   classVector <span class="op">=</span> <span class="va">cv5</span>,
                   
                   <span class="co"># CELLS TO RECLASSIFY HAVE THIS CLASS</span>
                   class <span class="op">=</span> <span class="fl">1</span>,
                   
                   <span class="co"># CELL MEETING CONDITIONS OF CLASS = 1 ARE RECLASSIFIED </span>
                   conditions <span class="op">=</span> <span class="st">"dummy_var{} &gt;= 3"</span>,
                    
                   <span class="co"># NEW CLASSIFICATION NUMBER</span>
                   reclass <span class="op">=</span> <span class="fl">2</span>,
                   
                   <span class="co"># RULE HAS TO BE TRUE FOR AT LEAST 100% OF THE EVALUATIONS</span>
                   fn_perc <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>


<span class="va">r_cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cr</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure11"></a></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cr</span><span class="op">)</span>
<span class="co">## [1] NA  2  0  1</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cells with values greater than the value of 60% of their neighbors</span>
<span class="co"># class = 2,  reclassified cells</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cr</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, 
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span>, <span class="st">"#1088a0"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/cond_reclass1_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 11 -</strong> Cells classified in <a href="#figure10">figure 10</a> are reclassified using the function <strong>cond.reclass</strong>, the rule <code>"dummy_var{} &gt;= 3"</code> and the argument <code>fn_perc = 1</code>. In <strong>light blue</strong>, the initial focal cell; in <strong>brown</strong>, cell classified in <a href="#figure10">figure 10</a>; in <strong>dark blue</strong>, reclassified cell; in <strong>grey</strong>, unclassified cells. Cells are reclassified if their value and the value of all their neighbors is <code>&gt;=3</code>.</span>
</div>
</div>
</div>
<div class="section level2">
<h2 id="neighbor-only-functions">Neighbor only functions<a class="anchor" aria-label="anchor" href="#neighbor-only-functions"></a>
</h2>
<p><strong>Functions:</strong> <code><a href="../reference/reclass.nbs.html">reclass.nbs()</a></code> and <code><a href="../reference/classify.all.html">classify.all()</a></code>.</p>
<p>Neighbor only functions are based only on class contiguity and continuity and do not present the argument <code>conditions</code>. Classifications performed by these functions are based on <a href="scapesClassification_01_2_RuleEvaluation.html#focal-evaluation">focal evaluations</a> and only take into account the spatial relationships existing among different groups of cells.</p>
<div class="section level3">
<h3 id="reclass-nbs">reclass.nbs<a class="anchor" aria-label="anchor" href="#reclass-nbs"></a>
</h3>
<p>The function <code><a href="../reference/reclass.nbs.html">reclass.nbs()</a></code> evaluates if members of two classes are contiguous and, if they are, one of them is reclassified.</p>
<p>In the following two examples we will use again the class vector <code>cv5</code> (<a href="#figure10">figure 10</a>) as a function input. This class vector has classes <code>0</code> (initial focal cell) and <code>1</code> (classified cells). Cells of class <code>1</code> adjacent to the initial focal cell (class <code>0</code>) will be reclassified as cells of class <code>2</code> (<a href="#figure12">Figure 12</a>).</p>
<ul>
<li>In the 1<sup>st</sup> example we use the argument <code>reclass_all = FALSE</code>, only cells of class <code>1</code> contiguous to the focal cell (class <code>0</code>) are reclassified as cells of class <code>2</code> (<a href="#figure12">Figure 12 - Left panel</a>);</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># RECLASSIFY NEIGHBORS</span>
<span class="va">cv_rec1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reclass.nbs.html">reclass.nbs</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                       ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                     
                       <span class="co"># CLASS VECTOR COMPUTED WITH THE RULE "dummy_var &gt; dummy_var{}"</span>
                       classVector <span class="op">=</span> <span class="va">cv5</span>,
                     
                       <span class="co"># CELLS OF CLASS...</span>
                       class <span class="op">=</span> <span class="fl">1</span>,
                     
                       <span class="co"># ...ADJACENT TO CELLS OF ANOTHER CLASS... </span>
                       nbs_of <span class="op">=</span> <span class="fl">0</span>,
                     
                       <span class="co"># ...WILL BE RECLASSIFIED...</span>
                       reclass <span class="op">=</span> <span class="fl">2</span>, 
                       
                       <span class="co"># NO MORE RECLASSIFICATIONS</span>
                       reclass_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>


<span class="va">r_cv_rec1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cv_rec1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<ul>
<li>In the 2<sup>nd</sup> example we use the argument <code>reclass_all = TRUE</code>, cells of class <code>1</code> contiguous to the focal cell (class <code>0</code>) are reclassified as cells of class <code>2</code>; all cells of class <code>1</code> connected to a reclassified cell are also reclassified (<a href="#figure12">Figure 12 - Right panel</a>).</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># RECLASSIFY NEIGHBORS</span>
<span class="va">cv_rec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reclass.nbs.html">reclass.nbs</a></span><span class="op">(</span>attTbl <span class="op">=</span> <span class="va">at</span>, 
                       ngbList <span class="op">=</span> <span class="va">nbs</span>, 
                     
                       <span class="co"># CLASS VECTOR COMPUTED WITH THE RULE "dummy_var &gt; dummy_var{}"</span>
                       classVector <span class="op">=</span> <span class="va">cv5</span>,
                     
                       <span class="co"># CELLS OF CLASS...</span>
                       class <span class="op">=</span> <span class="fl">1</span>,
                     
                       <span class="co"># ...ADJACENT TO CELLS OF ANOTHER CLASS... </span>
                       nbs_of <span class="op">=</span> <span class="fl">0</span>,
                     
                       <span class="co"># ...WILL BE RECLASSIFIED...</span>
                       reclass <span class="op">=</span> <span class="fl">2</span>, 
                       
                       <span class="co"># ...AND SO ALL CELLS OF CLASS 1 CONNECTED TO A RECLASSIFIED CELL</span>
                       reclass_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="va">r_cv_rec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.2.rast.html">cv.2.rast</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">at</span><span class="op">$</span><span class="va">Cell</span>,classVector <span class="op">=</span> <span class="va">cv_rec2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><a id="figure12"></a></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR LEVELS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv_rec1</span><span class="op">)</span> <span class="co"># ONLY CELLS ADJACENT TO THE FOCAL CELL ARE RECLASSIFIED</span>
<span class="co">## [1] NA  1  0  2</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv_rec2</span><span class="op">)</span> <span class="co"># ALL NON-NA CELL ARE RECLASSIFIED</span>
<span class="co">## [1] NA  2  0</span>

<span class="co"># class = 0,  focal cell</span>
<span class="co"># class = 1,  cells with values greater than the value of 60% of their neighbors</span>
<span class="co"># class = 2,  reclassified cells</span>
<span class="co"># class = NA, unclassified cells</span>

<span class="co"># PLOT THE CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv_rec1</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, 
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span>, <span class="st">"#1088a0"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"reclass_all = FALSE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_cv_rec2</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, colNA<span class="op">=</span><span class="st">"#818792"</span>, 
     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#78b2c4"</span>, <span class="st">"#cfad89"</span>, <span class="st">"#1088a0"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"reclass_all = TRUE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></code></pre></div>
<p><img src="scapesClassification_01_4_ClassFunctions_files/figure-html/reclass_nbs_plot-1.png" width="100%" style="display: block; margin: auto;"></p>
<div style="line-height: 0.8em; margin-bottom: 1.5em;">
<span class="legend"><strong>Figure 12 -</strong> Reclassify cells using the function <strong>reclass.nbs</strong> and class vector <code>cv5</code> (see <a href="#figure10">figure 10</a>). <strong>On the left</strong>, non-NA cells of <code>cv5</code> are reclassified if they are adjacent to the initial focal cell. <strong>On the right</strong>, non-NA cells of <code>cv5</code> are reclassified if they are adjacent to the initial focal cell; cells having the same class of a reclassified cell and connected to it are also reclassified. On both panels, <strong>in brown</strong>, non-NA cells of <code>cv5</code>; <strong>in light blue</strong>, the initial focal cell; <strong>in dark blue</strong>, reclassified cell; <strong>in grey</strong>, unclassified cells.</span>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gerald H. Taranto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
