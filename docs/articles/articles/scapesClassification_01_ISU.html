<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geomorphic Management Units (GMUs) • scapesClassification</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Geomorphic Management Units (GMUs)">
<meta property="og:description" content="scapesClassification">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">scapesClassification</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/scapesClassification_01_ISU.html">Geomorphic Management Units (GMUs)</a>
    </li>
    <li>
      <a href="../../articles/articles/scapesClassification_02_RU.html">Local maxima on gridded data</a>
    </li>
    <li>
      <a href="../../articles/articles/scapesClassification_03_RU.html">Independent objects on raster surfaces</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="scapesClassification_01_ISU_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Geomorphic Management Units (GMUs)</h1>
                        <h4 class="author">Gerald H. Taranto</h4>
            
            <h4 class="date">Wed 01, December, 2021</h4>
      
      
      <div class="hidden name"><code>scapesClassification_01_ISU.Rmd</code></div>

    </div>

    
    
<p>The following is an example of how to use <a href="https://github.com/ghTaranto/scapesClassification">scapesClassification</a> to classify marine seafloor structures, hereafter referred to as geomorphic management units (GMUs). Our study area is located in the ‘Triangle’ of the Azores (NE Atlantic), around the islands of Faial, Pico and São Jorge (<a href="#figure1">Figure 1</a>).</p>
<p>The GMU-classification will be presented in three separate articles:</p>
<ol style="list-style-type: decimal">
<li><p>This article presents the general workflow of a classification process implemented with <em>scapesClassification</em> (<a href="scapesClassification_01_ISU.html">Geomorphic management units</a>).</p></li>
<li><p>The second article presents a strategy to identify <em>local maxima</em> on gridded data (<a href="scapesClassification_02_RU.html">Local maxima on gridded data</a>).</p></li>
<li><p>The third article presents a strategy to identify independent objects on raster surfaces (<a href="scapesClassification_03_RU.html">Independent objects on raster surfaces</a>).</p></li>
</ol>
<div id="load-data-and-libraries" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data-and-libraries" class="anchor"></a>Load data and libraries</h1>
<p>Geomorphic management units (GMUs) will be identified using a <a href="https://rspatial.org/raster/spatial/4-rasterdata.html#rasterstack-and-rasterbrick"><code>RasterStack</code></a> of six layers that includes bathymetry, bathymetric derivatives (<a href="https://www.mdpi.com/2076-3263/8/3/94/htm">Walbridge et al., 2018</a>) and the geomorphons of the area (<a href="https://www.sciencedirect.com/science/article/pii/S0169555X12005028#!">Jasiewicz and Stepinski, 2013</a>):</p>
<ul>
<li>
<strong>Bathymetry:</strong> depth values;</li>
<li>
<strong>Local BPI:</strong> benthic position index (BPI) computed with an outer radius of 10px (ca. 5 km);</li>
<li>
<strong>Regional BPI:</strong> benthic position index (BPI) computed with an outer radius of 40px (ca. 20 km);</li>
<li>
<strong>Slope:</strong> slope values;</li>
<li>
<strong>SD bathymetry:</strong> standard deviation of bathymetric values computed on a 9x9 window;</li>
<li>
<strong>Geomorphons:</strong> identify basic morphological terrain types.</li>
</ul>
<p>We will start by loading the required libraries and data into the workspace:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># LOAD LIBRARIES</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scapesClassification</span><span class="op">)</span>

<span class="co"># LOAD DATA</span>
<span class="va">grd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"scapesClassification"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">grd</span> <span class="op">&lt;-</span> <span class="va">grd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"\\.grd"</span>, <span class="va">grd</span><span class="op">)</span><span class="op">]</span>
<span class="va">grd</span> <span class="op">&lt;-</span> <span class="va">grd</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"hillshade"</span>, <span class="va">grd</span><span class="op">)</span><span class="op">]</span>
<span class="va">rstack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html">stack</a></span><span class="op">(</span><span class="va">grd</span><span class="op">)</span></code></pre></div>
<p><a id="figure1"></a> We can plot the raster stack as an interactive map using the R packages <a href="https://r-spatial.github.io/mapview/"><code>mapview</code></a> and <a href="https://rstudio.github.io/leaflet/"><code>leaflet</code></a>:</p>
<p><em>FIGURE 1 - Raster layers used for the classification of Geomorphic Management Units (GMUs). The geomorphon classes correspond to (1) flat, (2) summit, (3) ridge, (4) shoulder, (5) spur, (6) slope, (7) hollow, (8) footslope, (9) valley and (10) depression.</em></p>
</div>
<div id="format-inputs" class="section level1">
<h1 class="hasAnchor">
<a href="#format-inputs" class="anchor"></a>Format inputs</h1>
<p>The classification process in <a href="https://github.com/ghTaranto/scapesClassification">scapesClassification</a> begins with the computation of two objects:</p>
<p><a id="atbl"></a></p>
<p><strong>Attribute table:</strong> the raster object converted into a <code>data.frame</code>. Attribute tables include only raster cells having no missing values. Function <code><a href="../../reference/attTbl.html">attTbl()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE ATTRIBUTE TABLE</span>
<span class="va">atbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/attTbl.html">attTbl</a></span><span class="op">(</span><span class="va">rstack</span>, var_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bathymetry"</span>, <span class="st">"gmorph"</span>, <span class="st">"local_bpi"</span>, <span class="st">"regional_bpi"</span>, <span class="st">"sd_bat"</span>, <span class="st">"slope"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># VIEW THE TOP 3 ROWS OF `atbl`</span>
<span class="co"># Each row corresponds to the raster cell indicated in atbl$Cell</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">atbl</span>, <span class="fl">3</span><span class="op">)</span> 
<span class="co">##   Cell bathymetry gmorph local_bpi regional_bpi   sd_bat    slope</span>
<span class="co">## 1    1  -1718.056      8        -4          129 55.40389 1.410384</span>
<span class="co">## 2    2  -1737.816      8        -3          107 49.10466 2.021313</span>
<span class="co">## 3    3  -1755.392      6        -1           87 42.76672 2.482018</span></code></pre></div>
<p><strong>Neighborhood list:</strong> the <code>list</code> of neighbors of every raster cell included in the attribute table. Function <code><a href="../../reference/ngbList.html">ngbList()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE NEIGHBORHOOD LIST</span>
<span class="va">nbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/ngbList.html">ngbList</a></span><span class="op">(</span><span class="va">rstack</span>, rNumb <span class="op">=</span> <span class="cn">TRUE</span>, attTbl <span class="op">=</span> <span class="va">atbl</span><span class="op">)</span> <span class="co"># neighbors are identified by their row number in the attribute table</span>

<span class="co"># VIEW THE TOP ELEMENT OF `nbs`</span>
<span class="va">nbs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">## $`1`</span>
<span class="co">## [1]   2 291 292</span>

<span class="co"># nbs[1] reads as:</span>
<span class="co"># the cell in row $`1` of `atbl` has </span>
<span class="co"># cells of rows 2, 291 and 292 as neighbors</span></code></pre></div>
</div>
<div id="island-shelf-unit-isu" class="section level1">
<h1 class="hasAnchor">
<a href="#island-shelf-unit-isu" class="anchor"></a>Island Shelf Unit (ISU)</h1>
<p>We can start our GMUs classification with the island shelf unit (ISU). The ISU comprises two main elements: <em>(i)</em> <strong>island shelves</strong> (i.e., relatively flat areas surrounding islands) and <em>(ii</em>) <strong>slopes</strong> (i.e., areas that connect island shelves to the seafloor).</p>
<div id="isu---anchor-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#isu---anchor-cells" class="anchor"></a>ISU - Anchor cells</h2>
<p>Anchor cells are raster cells that can be easily assigned to a class because of some distinctive attribute(s). For example, cells <strong><em>‘adjacent to an island’</em></strong> by definition are <em>‘island shelf cells’</em>. We can derive this initial set of <em>‘ISU-anchor cells’</em> using the functions:</p>
<p><strong><code><a href="../../reference/anchor.svo.html">anchor.svo()</a></code>:</strong> returns a vector of cell numbers extracted at the locations of a spatial vector object. In this example, <em>‘land cells’</em> are defined as: <em>(i)</em> raster cells extracted at island locations that are not complete cases (arg. <code>ONLY_NA = T</code>); <em>(ii)</em> cells adjacent to cells of point <em>(i)</em> that are not complete cases either (arg. <code>fill_NAs = T</code>) (<a href="#figure2">Figure 2</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ISLAND SHAPEFILE PATH</span>
<span class="va">shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Azores.shp"</span>, package <span class="op">=</span> <span class="st">"scapesClassification"</span><span class="op">)</span>

<span class="co"># EXTRACT LAND POSITIONS</span>
<span class="va">anchorLAND</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/anchor.svo.html">anchor.svo</a></span><span class="op">(</span>rstack              <span class="op">=</span> <span class="va">rstack</span>, 
                         spatial_vector_name <span class="op">=</span> <span class="va">shp</span>, 
                         only_NAs            <span class="op">=</span> <span class="cn">TRUE</span>, 
                         fill_NAs            <span class="op">=</span> <span class="cn">TRUE</span>, 
                         plot                <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><strong><code><a href="../../reference/anchor.cell.html">anchor.cell()</a></code>:</strong> converts a vector of cell numbers into a <strong>class vector</strong>. In this example, all cells adjacent to <em>‘land cells’</em> (arg. <code>class2cell = F</code> and <code>class2nbs = T</code>) will be considered as <em>‘ISU-anchor cells’</em> (<a href="#figure2">Figure 2</a>).</p>
<p><a id="ISU_anchor"></a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># COMPUTE ANCHOR CELLS</span>
<span class="va">anchorCELL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/anchor.cell.html">anchor.cell</a></span><span class="op">(</span>attTbl     <span class="op">=</span> <span class="va">atbl</span>, 
                          rstack     <span class="op">=</span> <span class="va">rstack</span>, 
                          anchor     <span class="op">=</span> <span class="va">anchorLAND</span>, 
                          class      <span class="op">=</span> <span class="fl">1</span>, <span class="co"># ANCHOR CELL CLASS = 1</span>
                          class2cell <span class="op">=</span> <span class="cn">FALSE</span>,
                          class2nbs  <span class="op">=</span> <span class="cn">TRUE</span>,
                          plot       <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<p>Class vectors map raster cells to numeric classes (or to NA-values if no class is attributed). The n<sup>th</sup> element of a class vector corresponds to the raster cell contained in the n<sup>th</sup> row of an attribute table.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CLASS VECTOR</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">anchorCELL</span><span class="op">)</span> 
<span class="co">## [1] NA  1</span>

<span class="co"># anchorCELL == 1,  ISU anchor cells</span>
<span class="co"># anchorCELL == NA, unclassified cells</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">anchorCELL</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span><span class="op">(</span><span class="va">atbl</span><span class="op">)</span>
<span class="co">## [1] TRUE</span></code></pre></div>
<p>Class vectors can be converted into a raster, plotted and saved using the function <code><a href="../../reference/cv.2.rast.html">cv.2.rast()</a></code>. However, here we will present classification outputs as interactive maps. <a id="figure2"></a></p>
<p><em>FIGURE 2 - <strong>Anchor cell:</strong> raster cells adjacent to a ‘land cell’. <strong>Land cell</strong>: raster cells extracted at the locations of the ‘island shapefile’ that are not complete cases and all adjacent cells that are not complete cases either. <strong>Complete cases</strong>: raster cells having no missing values in no layer of the stack (<a href="#figure1">Figure 1</a>); note that no overlap exists between “land cell” and “complete cases”. <strong>Island shapefile</strong>: the shapefile of Faial, Pico and São Jorge Islands.</em></p>
</div>
<div id="isu---island-shelf-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#isu---island-shelf-cells" class="anchor"></a>ISU - Island shelf cells</h2>
<p>In the previous section we identified the portion of ‘island shelves’ that is adjacent to an island. Another useful property is that ‘island shelves’ <strong><em>tend to be flat</em></strong>. This property is shared by several classes (e.g., flat tops or abyssal plains), but it can still define ‘island shelves’ if considered in the context of class contiguity and continuity.</p>
<p>We will use the following set of rules to identify the <em>‘island shelf cells’</em>:</p>
<ol style="list-style-type: lower-alpha">
<li>We assume that a cell is flat if its <code>slope &lt; 5º</code>;</li>
<li>Flat cells adjacent to <em>‘island shelf cells’</em> are classified as <em>‘island shelf’</em> (<em>class contiguity</em>);</li>
<li>As long as new <em>‘island shelf cells’</em> are identified, rule b can be evaluated for new adjacent cells (<em>class continuity</em>);</li>
</ol>
<p>This set of rules can be evaluated using the function:</p>
<p><strong><code><a href="../../reference/cond.4.nofn.html">cond.4.nofn()</a></code>:</strong> Evaluate conditions for cells neighboring specific classes. In this case, the function identifies the <em>‘flat cells’</em> of island shelves based on the above set of rules (<a href="#figure3">Figure 3</a>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ISU SHELF CELLS (FLAT CELLS)</span>
<span class="va">flatCELLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span><span class="va">atbl</span>, <span class="va">nbs</span>, nbsIndex <span class="op">=</span> <span class="cn">T</span>,
                         
                         <span class="co"># `anchorCELL` class vector</span>
                         classVector <span class="op">=</span> <span class="va">anchorCELL</span>,  
                         
                         <span class="co"># flat cell class </span>
                         class <span class="op">=</span> <span class="fl">2</span>,
                         
                         <span class="co"># evaluate cells adjacent to anchor cells (class=1) or flat cells (class=2)</span>
                         nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, 
                         
                         <span class="co"># condition string (slope refers to the column `slope` of `atbl`)</span>
                         conditions <span class="op">=</span> <span class="st">"slope &lt;= 5"</span>, 
                         
                         <span class="co"># a cell is classified if conditions are true AND if at least 20% of its neighboring cells belong to one of the classes of the argument `nbs_of`</span>
                         min.border <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p>Once <em>‘flat cells’</em> have been identified, we will assume that raster cells surrounded by <em>‘island shelf cells’</em> are also <em>‘island shelf cells’</em>. We define a cell as surrounded if 60% of its neighbors belong to an ‘island shelf’ class (<em>‘hole cell’</em>, <a href="#figure3">Figure 3</a>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ISU SHELF CELLS (FILL CLASSIFICATION HOLES)</span>
<span class="va">holeCELLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span><span class="va">atbl</span>, <span class="va">nbs</span>, nbsIndex <span class="op">=</span> <span class="cn">T</span>,
                         
                         <span class="co"># `flatCELLS` class vector</span>
                         classVector <span class="op">=</span> <span class="va">flatCELLS</span>, 
                         
                         <span class="co"># hole cell class</span>
                         class <span class="op">=</span> <span class="fl">3</span>,    
                         
                         <span class="co"># evaluate cells adjacent to anchor cells (class=1), flat cells (class=2) or hole cells</span>
                         nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
                         
                         <span class="co"># conditions are always true</span>
                         conditions <span class="op">=</span> <span class="st">"TRUE"</span>,
                         
                         <span class="co"># a cell is classified if at least 60% of its neighboring cells belong to one of the classes of the argument `nbs_of`</span>
                         min.border <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>    </code></pre></div>
<p>Class vectors are updated each time they are passed to a classification function. Cells that have not been classified and that meet the conditions get a classification number. The class vector <code>holeCELLS</code> was the latest to be computed and resulted from the updates of <code>anchorCELL</code> and <code>flatCELLS</code>. Therefore, it includes all island shelf cells (<a href="#figure3">Figure 3</a>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ISLAND SHELF CELLS</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">holeCELLS</span><span class="op">)</span>
<span class="co">## [1] NA  2  3  1</span>

<span class="co"># holeCELLS == 1,  ISU anchor cells</span>
<span class="co"># holeCELLS == 2,  ISU flat cells</span>
<span class="co"># holeCELLS == 3,  ISU hole cells</span>
<span class="co"># holeCELLS == NA, Other cells</span></code></pre></div>
<p><a id="figure3"></a></p>
<p><em>FIGURE 3 - <strong>Anchor cell:</strong> raster cells adjacent to a ‘land cell’. <strong>Flat cell:</strong> raster cells with slopes &lt; 5º respecting class contiguity and continuity with island shelf cells. <strong>Hole cell:</strong> raster cell whose 60% of neighboruring cells are classified as island shelf cells. <strong>Slope:</strong> slope values. Because of reprojection (resampling) displayed and original values might be slightly different.</em></p>
</div>
<div id="ISU_slope" class="section level2">
<h2 class="hasAnchor">
<a href="#ISU_slope" class="anchor"></a>ISU - Slope cells</h2>
<p>We can identify <em>‘slope cells’</em> using the function <code><a href="../../reference/cond.4.nofn.html">cond.4.nofn()</a></code> to evaluate three sets of conditions. All sets of conditions will take into account class contiguity and continuity.</p>
<p><strong><em>Slope1 cell.</em></strong> In the first set of conditions we consider that in regions adjacent to island shelves, <em>‘slope cells’</em> tend to have positive BPI values (<code>regional_bpi &gt; 100</code>) (<em>‘Slope1 cell’</em>, <a href="#figure4">Figure 4</a>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slope1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span><span class="va">atbl</span>, <span class="va">nbs</span>, nbsIndex <span class="op">=</span> <span class="cn">T</span>,
                      
                      <span class="co"># `holeCELLS` class vector</span>
                      classVector <span class="op">=</span> <span class="va">holeCELLS</span>,
                      
                      <span class="co"># slope1 cell class</span>
                      class <span class="op">=</span> <span class="fl">4</span>,
                      
                      <span class="co"># evaluate cells adjacent to ISU cells</span>
                      nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, 
                      
                      <span class="co"># condition string (regional_bpi refers to the column `regional_bpi` of `atbl`)</span>
                      conditions <span class="op">=</span> <span class="st">"regional_bpi &gt; 100"</span>,
                      
                      <span class="co"># a cell is classified if conditions are true AND if at least 20% of its neighboring cells belongs to one of the classes of the argument `nbs_of`</span>
                      min.border <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p><strong><em>Slope2 cell.</em></strong> In the second set of conditions we consider that small ridges connected to the ISU are also part of the ISU. Small ridges tend to have high local BPI values (<code>local_bpi{} &gt; 100</code>). Note that we use the tag <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> after the variable <code>local_bpi</code> and the argument <code>fn_perc = 0.4</code>. The tag <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> flags <em>absolute focal neighborhood conditions</em>, and <code>fn_perc = 0.4</code> states that the focal cell is classified only if conditions are true for at least 40% of the cells included in the focal neighborhood (<em>‘Slope2 cells’</em>, <a href="#figure4">Figure 4</a>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slope2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span><span class="va">atbl</span>, <span class="va">nbs</span>, nbsIndex <span class="op">=</span> <span class="cn">T</span>,
                      
                      <span class="co"># `slope1` class vector</span>
                      classVector <span class="op">=</span> <span class="va">slope1</span>, 
                      
                      <span class="co"># slope2 cell class</span>
                      class <span class="op">=</span> <span class="fl">5</span>,
                      
                      <span class="co"># evaluate cells adjacent to ISU cells</span>
                      nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, 
                      
                      <span class="co"># condition string (local_bpi refers to the column `local_bpi` of `atbl`, `{}` flags an absolute focal neighborhood condition)</span>
                      conditions <span class="op">=</span> <span class="st">"local_bpi{} &gt; 100"</span>, 
                      
                      <span class="co"># a cell is classified if conditions are true for at least 40% of the cells in the focal cell neighborhood</span>
                      fn_perc <span class="op">=</span> <span class="fl">0.4</span>,
                      
                      <span class="co"># a cell is classified if conditions are true AND if at least 20% of its neighboring cells belong to one of the classes of the argument `nbs_of`</span>
                      min.border <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p><strong><em>Slope3 cell.</em></strong> In the third set of conditions we consider that even cells having negative BPI values can be part of <em>‘ISU slopes’</em>. We can assume that as long as there is an high bathymetric variation around a raster cell connected to a slope the seafloor has not been reached. We will set this condition using again the <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> tag (<code>sd_bat{} &gt; 150</code>), but we will change <code>fn_perc = 1</code> (<em>‘Slope3 cell’</em>, <a href="#figure4">Figure 4</a>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slope3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/cond.4.nofn.html">cond.4.nofn</a></span><span class="op">(</span><span class="va">atbl</span>, <span class="va">nbs</span>, nbsIndex <span class="op">=</span> <span class="cn">T</span>,
                      
                      <span class="co"># `slope2` class vector</span>
                      classVector <span class="op">=</span> <span class="va">slope2</span>, 
                      
                      <span class="co"># slope3 cell class</span>
                      class <span class="op">=</span> <span class="fl">6</span>,
                      
                      <span class="co"># evaluate cells adjacent to ISU cells</span>
                      nbs_of <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, 
                      
                      <span class="co"># condition string (sd_bat refers to the column `sd_bat` of `atbl`, `{}` flags an absolute focal neighborhood condition)</span>
                      conditions <span class="op">=</span> <span class="st">"sd_bat{} &gt; 150"</span>, 
                      
                      <span class="co"># a cell is classified if conditions are true for 100% of the cells in the focal cell neighborhood</span>
                      fn_perc <span class="op">=</span> <span class="fl">1</span>,
                      
                      <span class="co"># a cell is classified if conditions are true AND if at least 20% of its neighboring cells belong to one of the classes of the argument `nbs_of`</span>
                      min.border <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p><a id="figure4"></a> We can plot the result of the <em>‘ISU slope’</em> classification:</p>
<p><em>FIGURE 4 - Island shelf units (ISUs) identified by slope and island shelf cells. In background are provided BPI and SD bathymetry values; because of reprojection displayed and original values are slightly different.</em></p>
</div>
<div id="isu---class-vector" class="section level2">
<h2 class="hasAnchor">
<a href="#isu---class-vector" class="anchor"></a>ISU - Class vector</h2>
<p>The class vector <code>slope3</code> includes all ISU-cells (<a href="#figure4">Figure 4</a>). It can be saved as an <code>*.RDS</code> file and used in the next article (<a href="scapesClassification_02_RU.html">Local maxima on gridded data</a>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ISU CELLS</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">slope3</span><span class="op">)</span>
<span class="co">## [1] NA  6  5  4  2  3  1</span>

<span class="co"># slope3 == 1,  ISU anchor cells</span>
<span class="co"># slope3 == 2,  ISU flat cells</span>
<span class="co"># slope3 == 3,  ISU hole cells</span>

<span class="co"># slope3 == 4,  ISU slope1 cells</span>
<span class="co"># slope3 == 5,  ISU slope2 cells</span>
<span class="co"># slope3 == 6,  ISU slope3 cells</span>

<span class="co"># slope3 == NA, Non-ISU cells</span>

<span class="co"># SAVE `slope3`</span>
<span class="co"># saveRDS(slope3, "ISU_Cells.RDS")</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gerald H. Taranto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
